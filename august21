package com.learningselenium.testscripts;

import java.io.File;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.file.Files;
import java.time.Duration;
import java.util.*;
import java.util.function.Function;
import java.util.stream.Collectors;
import java.util.stream.Stream;

import org.openqa.selenium.By;
import org.openqa.selenium.JavascriptExecutor;
import org.openqa.selenium.Keys;
import org.openqa.selenium.OutputType;
import org.openqa.selenium.TakesScreenshot;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.WindowType;
import org.openqa.selenium.edge.EdgeDriver;
import org.openqa.selenium.edge.EdgeOptions;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.FluentWait;
import org.openqa.selenium.support.ui.Wait;
import org.testng.annotations.Test;
import org.testng.asserts.SoftAssert;
import static org.openqa.selenium.support.locators.RelativeLocator.*;

public class SeleniumPractice {
	public static void main(String[] args) throws InterruptedException, IOException { 
//		// Browser Options 
//		EdgeOptions options=new EdgeOptions();
//		options.setAcceptInsecureCerts(true);
//		WebDriver driver=new EdgeDriver(options);
//		driver.get("https://expired.badssl.com/");

//		// Screenshot
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://www.leetcode.com");
//		File src=((TakesScreenshot)driver).getScreenshotAs(OutputType.FILE);
//		File dest=new File("C:\\Users\\kaush\\OneDrive\\Documents\\Screenshot7.png");
//		Files.copy(src.toPath(),dest.toPath());
		
//		// Check for Broken Link
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://rahulshettyacademy.com/AutomationPractice/");
//		String url=driver.findElement(By.linkText("Broken Link")).getAttribute("href");
//		System.out.println(url);
//		HttpURLConnection conn=(HttpURLConnection)new URL(url).openConnection();
//		conn.connect();
//		System.out.println(conn.getResponseCode());

//		// Hard v Soft Allert
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://rahulshettyacademy.com/AutomationPractice/");
//		List<WebElement> links=driver.findElements(By.cssSelector("li[class='gf-li'] a"));
//		SoftAssert a=new SoftAssert();
//		for (WebElement link:links) {
//	        String url=link.getAttribute("href");
//	        System.out.println(url);
//	        HttpURLConnection conn=(HttpURLConnection)new URL(url).openConnection();
//	        conn.setRequestMethod("HEAD");
//	        conn.connect();
//	        int resCode=conn.getResponseCode();
//	        System.out.println(resCode);
//            // Assert.assertTrue(resCode<=400, "The link with text "+link.getText()+" and url "+link.getAttribute("href")+" is broken with code"+resCode);  //Hard Assertion
//	        a.assertTrue(resCode<400  , "The link with text "+link.getText()+" and url "+link.getAttribute("href")+" is broken with code"+resCode);
//		}
//		a.assertAll();
	}
	
	@Test
	public void javaStreams() throws InterruptedException, IOException {
//		// Streams in Java
//		ArrayList<String> names=new ArrayList();
//		names.add("Aarav");
//		names.add("Vivaan");
//		names.add("Reyansh");
//		names.add("Ayaan");
//		names.add("Ishaan");
//		names.add("Kabir");
//		names.add("Arjun");
//		System.out.println(names.stream().filter(s->s.startsWith("A")).count());
//		// Terminal operation executes only if intermediate operations return true
//		System.out.println(Stream.of("Aarav","Vivaan","Reyansh","Ayaan","Ishaan","Kabir","Arjun","Myra","Ananya","Diya").filter(s->{
//			 if (s.startsWith("K")) return true; 
//			 else return false;
//		}).count()); 
//		names.stream().filter(s->s.length()>4).forEach(s->System.out.println(s));
//		Stream.of("Aarav","Vivaan","Reyansh","Ayaan","Ishaan","Kabir","Arjun","Ananya","Diya","Myra").filter(s->s.endsWith("a")).map(s->s.toUpperCase()).forEach(s->System.out.println(s));
//		List<String> lis=Stream.of("Aarav","Vivaan","Reyansh","Ayaan","Ishaan","Kabir","Arjun","Ananya","Diya","Myra").filter(s->s.endsWith("a")).collect(Collectors.toList());
//		System.out.println(lis);
		
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://rahulshettyacademy.com/seleniumPractise/#/offers");
//		driver.findElement(By.xpath("//tr/th[1]")).click();
//		List<WebElement> lis=driver.findElements(By.xpath("//tr/td[1]"));
//		List<String> org=lis.stream().map(s->s.getText()).collect(Collectors.toList());
//		List<String> sorted=org.stream().sorted().collect(Collectors.toList());
//		System.out.println("Is veggie names sorted? "+org.equals(sorted));
		
//		// Map and collect in Java Streams
//		List<Integer> prices;
//		do {
//			List<WebElement> rows=driver.findElements(By.xpath("//tr/td[1]"));
//			prices=rows.stream()
//					.filter(s->s.getText().contains("Cherry"))
//					.map(el->el.findElement(By.xpath("following-sibling::td[1]")).getText())
//					.map(s->Integer.parseInt(s))
//					.collect(Collectors.toList());
//			prices.forEach(a->System.out.println(a));
//			if (prices.size()<1) driver.findElement(By.cssSelector("[aria-label='Next']")).click();
//		} while (prices.size()<1);
		
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://rahulshettyacademy.com/seleniumPractise/#/offers");
//		String x="to";
//		driver.findElement(By.id("search-field")).sendKeys(x);
//		List<WebElement> veggies=driver.findElements(By.xpath("//tr/td[1]"));
//		List<WebElement> filtered=veggies.stream().filter(veggie->veggie.getText().contains(""+x+"")).collect(Collectors.toList());
//		System.out.println(veggies.size()==filtered.size()?"Sizes match: "+veggies.size():"Mismatch->veggies: "+veggies.size()+",filtered:"+filtered.size());
		
//		// Relative Locators
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://rahulshettyacademy.com/angularpractice/");
//		WebElement nameBox=driver.findElement(By.name("name"));
//		System.out.println(driver.findElement(with(By.tagName("label")).above(nameBox)).getText());
//		WebElement dateofBirth=driver.findElement(By.cssSelector("[for='dateofBirth']"));
//		driver.findElement(with(By.tagName("input")).below(dateofBirth)).click();
//		WebElement checkboxRight=driver.findElement(By.xpath("//label[@for='exampleCheck1']"));
//		driver.findElement(with(By.tagName("input")).toLeftOf(checkboxRight)).click();
//		WebElement rdb=driver.findElement(By.id("inlineRadio1"));
//		System.out.println(driver.findElement(with(By.tagName("label")).toRightOf(rdb)).getText());
		
//		// Invoking New tab
//		WebDriver driver=new EdgeDriver();
//		driver.get("https://rahulshettyacademy.com/angularpractice/");
//		driver.switchTo().newWindow(WindowType.TAB);
//		Set<String> windowIds=driver.getWindowHandles();
//		Iterator<String> it=windowIds.iterator();
//		String parId=it.next();
//		String childId=it.next();
//		driver.switchTo().window(childId);
//		driver.get("https://rahulshettyacademy.com/");
//		Thread.sleep(3000);
//		String name=driver.findElement(By.xpath("//a[contains(text(),'All-Access Membership-Complete Access to 25+ Cours')]")).getText();
//		System.out.println(name);
//		driver.switchTo().window(parId);
//		driver.findElement(By.name("name")).sendKeys(name);
		
		// Partial Screenshot
		WebDriver driver=new EdgeDriver();
		driver.get("https://rahulshettyacademy.com/angularpractice/");
		WebElement name=driver.findElement(By.name("name"));
		File src=name.getScreenshotAs(OutputType.FILE);
		File dest=new File("C:\\Users\\kaush\\OneDrive\\Documents\\Screenshot9.png");
		Files.copy(src.toPath(),dest.toPath());
		// Dimensions of element
		System.out.println(name.getRect().getDimension().getHeight());
		System.out.println(name.getRect().getDimension().getWidth());
	}
}
